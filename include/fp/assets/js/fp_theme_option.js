jQuery(document).ready((function(e){const t=[{name:"Movie",slug:"movie"},{name:"Series",slug:"series"},{name:"Both",slug:"both"}];function i(){e("#show-social").is(":checked")?(e("#social-list").show().css("display","flex"),e("#show-social-base-wrapper").removeClass("hidden").css("display","flex")):(e("#social-list").hide(),e("#show-social-base-wrapper").hide())}i(),e("#show-social").on("change",(function(){i()}));let n={basic_settings:{},customize_settings:{homepage_layout:[],single_layout:[]}};function s(){let t=function(){let t=e("#footer-text").val().trim();t=h(t);let i={logo:e("#logo-url-relative-path").val(),favicon:e("#favicon-url-relative-path").val(),max_width:e("#max-width").val(),show_social:!!e("#show-social").is(":checked"),social_base_icon:e("#social-text-icon").val(),social_list:[],footer_text:t};return e(".single-social-container").each((function(){let t={icon:e(this).find(".social-icon").val(),title:e(this).find(".social-title").val(),color:e(this).find(".social-color").val(),link:e(this).find(".social-link").val()};t.title&&t.link&&i.social_list.push(t)})),i}(),i=function(){let t=[];return e("#homepage-items li").each((function(){let i=e(this).find(".i_type").text().replace("Type: ",""),n={type:i,content_type:e(this).find(".i_content_type").text().replace("Content Type: ",""),limit:e(this).find(".i_limit").text().replace("Limit: ","")||"10",title_background:e(this).find(".i_title_background").text().replace("Title Background Effect: ",""),image_source:e(this).find(".i_image_source").text().replace("Image Source: ",""),image_size:e(this).find(".i_image_size").text().replace("Image Size: ","")};"taxonomy"===i&&(n.taxonomy=e(this).find(".i_taxonomy").text().replace("Taxonomy: ","")),"featured"!==i&&(n.heading=e(this).find(".i_heading").text().replace("Heading: ",""),n.show_ratings="Yes"===e(this).find(".i_show_ratings").text().replace("Show Ratings: ",""),n.show_quality="Yes"===e(this).find(".i_show_quality").text().replace("Show Quality: ","")),isNaN(n.limit)?alert("Limit must be a number."):t.push(n)})),t}(),s=function(){let t=[];return e("#singlepage-items li").each((function(){let i=e(this).find(".i_shortcode").text().replace("Shortcode: ",""),n={shortcode:i};if("fp-universal-view"===i){n.content_type=e(this).find(".i_content_type").text().replace("Type: ","");let t=e(this).find(".i_content").html().replace('<span class="inline-block min-w-24 me-1 font-semibold">Content: </span>',"");t=t.replace(/<img[^>]*alt="([^"]*)"[^>]*>/g,"$1"),t=h(t),n.content=t}t.push(n)})),t}();return n.basic_settings=t,n.customize_settings.homepage_layout=i,n.customize_settings.single_layout=s,n}let a={"#select-basic":"#fp-basic-settings","#select-customize":"#fp-customize-settings","#select-other":"#fp-other-settings"};function o(t,i,n){e(t).on("click",(function(t){t.preventDefault(),e(i).val(""),e(n).attr("src","")}))}function l(t,i,n){e(t).on("click",(function(t){t.preventDefault();let s=wp.media({title:"Select Image",button:{text:"Use this image"},multiple:!1}).on("select",(function(){let t=s.state().get("selection").first().toJSON();e(i).val(t.url),e(n).attr("src",t.url)})).open()}))}function c(){e(".social-color").each((function(){e(this).wpColorPicker({change:function(t,i){var n=i.color.toString();e(this).closest(".single-social-container").find(".color-preview-box").css("background-color",n)}})}))}function r(t){"taxonomy"===t?(e("#hp-taxonomy-section, #h-heading-view, #h-show-ratings, #h-show-quality").removeClass("hidden").css("display","flex"),d()):"featured"===t?(e("#hp-taxonomy-section, #h-heading-view, #h-show-ratings, #h-show-quality").addClass("hidden").css("display","none"),p()):(e("#hp-taxonomy-section").addClass("hidden").css("display","none"),e("#h-heading-view, #h-show-ratings, #h-show-quality").removeClass("hidden").css("display","flex"),p())}function d(){let t=e("#hp-taxonomy").val();t&&e.ajax({url:fp_Data.ajaxurl,type:"POST",data:{action:"fp_get_taxonomy_data",nonce:fp_Data.tax_nonce,taxonomy:t},success:function(t){t.data&&function(t){let i=e("#hp-content-type");i.empty(),e.each(t,(function(e,t){i.append(new Option(t.name,t.slug))}))}(t.data)},error:function(){alert("Failed to fetch content types.")}})}function p(){let i=e("#hp-content-type");i.empty(),e.each(t,(function(e,t){i.append(new Option(t.name,t.slug))}))}function h(e){const t=(new TextEncoder).encode(e);return btoa(String.fromCharCode.apply(null,t))}Object.keys(a).forEach((t=>{let i=a[t];e(t).on("click",(function(){Object.keys(a).forEach((t=>{e(a[t]).hide(),e(t).removeClass("active")})),e(i).show().css("display","flex"),e(t).addClass("active")}))})),o("#remove-logo","#logo-url-relative-path","#fp-logo-p"),o("#remove-favicon","#favicon-url-relative-path","#fp-fav-p"),l("#logo-uploader","#logo-url-relative-path","#fp-logo-p"),l("#favicon-uploader","#favicon-url-relative-path","#fp-fav-p"),e("#max-width").on("input",(function(){let t=parseInt(e(this).val());e("#max-width-text").text(t+"px")})),e("#add-new-social").on("click",(function(){e("#single-social-container-wrapper").append('\n    <div class="single-social-item flex flex-col justify-between items-center bg-gray-900 p-2 gap-4 flex-1">\n      <div class="single-social-container relative flex flex-col gap-3 justify-center items-start p-2 self-start">\n          <div class="flex flex-col md:flex-row gap-2">\n            <label for="social-icon" class="min-w-[120px] max-w-[120px] overflow-hidden">Bootstrap Icon\n            <a href="https://icons.getbootstrap.com/" target="_blank" class="text-base mx-2" style="color: #01fef3;">?</a>\n            </label>\n            <input class="social-icon min-w-0" type="text" value=\'\' placeholder="bi bi-facebook" />\n          </div>\n          <div class="flex flex-col md:flex-row gap-2">\n            <label for="social-title" class="min-w-[120px] max-w-[120px] overflow-hidden">Title</label>\n            <input class="social-title min-w-0" type="text" value=\'\' placeholder="Facebook" />\n          </div>\n\n\n          <div class="flex flex-col md:flex-row gap-2">\n            <label for="social-color" class="min-w-[120px] max-w-[120px] overflow-hidden">Color</label>\n            <input class="social-color min-w-0" type="text" value=\'#ffffff\' />\n          </div>\n\n          <div class="flex flex-col md:flex-row gap-2">\n            <label for="social-link" class="min-w-[120px] max-w-[120px] overflow-hidden">Link</label>\n            <input class="social-link min-w-0" type="text" value=\'\' placeholder="https://facebook.com" />\n          </div>\n      </div>\n      <div class="remove-social cursor-pointer flex justify-center items-center gap-2 bg-red-700 px-3 py-2 rounded">\n        <i class="bi bi-x-circle-fill rounded text-xs text-gray-200 hover:text-gray-400 cursor-pointer"></i>\n        <span class="text-sm text-gray-400 font-semibold">Remove</span>\n      </div>\n    </div>'),c()})),c(),e(document).on("click",".remove-social",(function(){e(this).closest(".single-social-item").remove()})),e("#save-theme-settings").on("click",(function(){let t=s();e(this).prop("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"fp_save_theme_settings",settings:t,nonce:fp_Data.save_nonce},success:function(t){t.success?alert("Settings saved successfully!"):alert("There was an error saving the settings."),e("#save-theme-settings").prop("disabled",!1)},error:function(){alert("AJAX request failed."),e("#save-theme-settings").prop("disabled",!1)}})})),e("#homepage-items").sortable({handle:".bi-arrows-move"}),r(e("#hp-type").val()),e("#hp-type").on("change",(function(){r(e(this).val())})),e("#add-homepage-item").on("click",(function(){let t=e("#hp-type").val(),i=e("#hp-content-type").val(),n=e("#hp-heading").val(),s=e("#hp-limit").val(),a=e("#hp-title-bg-effect").val(),o=e("#hp-image-source").val(),l=e("#hp-taxonomy").val(),c=e("#hp-image-size").val()||"original",r=e("#hp-show-ratings").is(":checked")?1:0,d=e("#hp-show-quality").is(":checked")?1:0;if(!(t&&i&&s&&a&&o))return void alert("Please ReCheck All Fields.");if("meta"===t&&!n)return void alert("Please enter a heading.");if("taxonomy"===t&&!l)return void alert("Please select a taxonomy.");let p="taxonomy"===t||"meta"===t,h=`<div class="sortable-item bg-gray-800 p-3 mb-2 rounded">\n                        <i class="bi bi-arrows-move"></i>\n                        <li>\n                            <div class="i_type"><strong>Type:</strong> ${t}</div>\n                            <div class="i_content_type"><strong>Content Type:</strong> ${i}</div>\n                            <div class="i_limit"><strong>Limit:</strong> ${s}</div>\n                            <div class="i_title_background"><strong>Title Background Effect:</strong> ${a}</div>\n                            <div class="i_image_source"><strong>Image Source:</strong> ${o}</div>\n                            <div class="i_image_size"><strong>Image Size:</strong> ${c}</div>\n                            \n                            ${"taxonomy"===t?`<div class="i_taxonomy"><strong>Taxonomy:</strong> ${l}</div>`:""}\n                            ${p?`<div class="i_heading"><strong>Heading:</strong> ${n}</div>`:""}\n                            ${p?`<div class="i_show_ratings"><strong>Show Ratings:</strong> ${r?"Yes":"No"}</div>`:""}\n                            ${p?`<div class="i_show_quality"><strong>Show Quality:</strong> ${d?"Yes":"No"}</div>`:""}\n                        </li>\n                        <button class="remove-item remove-btn-base">Remove</button>\n                    </div>`;e("#homepage-items").append(h)})),e(document).on("click",".remove-item",(function(){e(this).closest(".sortable-item").remove()})),e("#hp-taxonomy").on("change",(function(){d()})),e("#singlepage-items").sortable({handle:".bi-arrows-move"}),"fp-universal-view"===e("#sp-shortcode").val()&&(e("#universal-content-type-wrapper").removeClass("hidden").css("display","flex"),e("#universal-view-textarea").removeClass("hidden").css("display","flex")),e("#sp-shortcode").on("change",(function(){"fp-universal-view"===e(this).val()?(e("#universal-content-type-wrapper").removeClass("hidden").css("display","flex"),e("#universal-view-textarea").removeClass("hidden").css("display","flex")):(e("#universal-content-type-wrapper").addClass("hidden").css("display","none"),e("#universal-view-textarea").addClass("hidden").css("display","none"))})),e("#add-singlepage-item").on("click",(function(){let t=e("#sp-shortcode").val();if("fp-universal-view"===t){var i=e("#universal-content").val(),n=e("#universal-content-type").val();if(!i||!n)return void alert("Please enter content and select content type.");i=i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}let s=!1;if("fp-universal-view"!==t&&e("#singlepage-items .i_shortcode").each((function(){e(this).text().includes(t)&&(s=!0)})),s)return void alert("Already Added. This shortcode can only be added once.");let a=`\n        <div class="sortable-item bg-gray-800 rounded flex justify-start items-center px-3 py-2 mb-3">\n            <i class="bi bi-arrows-move"></i>\n            <li id="single-shortcode-list" class="flex-1 flex gap-5">\n                <div class="i_shortcode"><span class="inline-block min-w-24 me-1 font-semibold">Shortcode: </span>${t}</div>\n                ${"fp-universal-view"===t?`<div class="i_content_type"><span class="inline-block min-w-24 me-1 font-semibold">Type: </span>${n}</div>`:""}\n                ${"fp-universal-view"===t?`<div class="i_content"><span class="inline-block min-w-24 me-1 font-semibold">Content: </span>${i}</div>`:""}\n            </li>\n            <button class="remove-item mt-2 px-3 py-2 bg-red-600 text-white font-semibold">Remove</button>\n        </div>`;e("#singlepage-items").append(a),e("#universal-content").val(""),e("#universal-view-textarea").addClass("hidden")})),e(document).on("click",".remove-item",(function(){e(this).closest(".sortable-item").remove()}))}));