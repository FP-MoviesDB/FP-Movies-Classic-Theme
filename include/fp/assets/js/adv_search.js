jQuery(document).ready((function(t){var e={};const s=t("#adv-search-btn"),i=t(".trending-searches-items"),a=t("#active-filters");let n=1,c=0,l=null,o=null;function r(){t(".custom-multiselect").each((function(){t(this).find('input[type="checkbox"]:checked').prop("checked",!1),t(this).find('input[type="radio"]:checked').prop("checked",!1),setTimeout((()=>p()),100),setTimeout((()=>f()),100)}))}function p(){e={},t(".custom-multiselect").each((function(){var s=t(this).find(".select-box span").first().data("tagid"),i=t(this).find('input[type="checkbox"]:checked, input[type="radio"]:checked').map((function(){return t(this).val()})).get();i.length>0&&(e[s]=i)}))}function d(){t(".search-adv-loader").empty()}function u(t=!1){t?(s.css("pointer-events","auto"),s.css("opacity",1)):(s.css("pointer-events","none"),s.css("opacity",.5))}function f(){const s=t("#adv-search-input").val();if(s===l&&JSON.stringify(e)===JSON.stringify(o)&&n===c)return;if(a.empty(),Object.keys(e).length>0){a.append('<i class="bi bi-x remove-filter-btn px-2 py-1 text-white cursor-pointer bg-red-700 absolute -top-3 right-2 text-xs rounded-3xl">RESET</i>');let t='<div class="flex flex-wrap justify-start items-center pt-5 pb-1 gap-3">';for(const[s,i]of Object.entries(e))i.forEach((e=>{t+='<div class="active-filter-item flex justify-between items-center px-3 py-2 bg-[#333] rounded-md" data-tagid="'+s+'" data-tagvalue="'+e+'"><span class="text-white text-sm">'+e+"</span></div>"}));t+="</div>",a.append(t)}t("#search-results .search-results-list").empty(),t(".search-adv-loader").html('<div class="spinner-wrapper"><div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div></div>'),u(!1),t.ajax({url:fp_asData.ajaxurl,method:"POST",dataType:"json",data:{action:"fp_perform_search",nonce:fp_asData.nonce,search:s,filters:e,paged:n},success:function(i){d(),i.success?(l=s,o=e,function(e){const s=t("#search-results .search-results-list");if(s.empty(),0===e.length)return void s.append("<p style='text-align: center; width: 100%'>No results found</p>");e.forEach((e=>{const i=t("<div>",{class:"search-results-list-item flex justify-start items-center flex-col w-[150px] md:w-[200px] overflow-hidden"}),a=t("<a>",{href:e.p_link,class:"flex flex-col"}),n=t("<div>",{class:"overflow-hidden w-[150px] md:w-[200px] max-h-[250px] md:max-h-[300px]"}),c=t("<img>",{src:e.thumb||"https://dummyimage.com/200x2:3/333/fff.jpg?text=NO+IMAGE",alt:"Poster",class:"object-cover hover:scale-110 transition-transform duration-300 w-[150px] md:w-[200px] max-h-[250px] md:max-h-[300px] min-h-[250px] md:min-h-[300px]"}),l=t("<div>",{class:"search-results-list-item-content inline-flex flex-col"}),o=t("<h3>",{class:"adv-result-title text-sm font-semibold text-white text-center p-2 text-wrap",text:t("<div>").html(e.title).text()});l.append(o),n.append(c),a.append(n,l),i.append(a),s.append(i)}))}(i.data.results),function(e){const s=t(".search-result-pagination-wrapper");if(s.empty(),e.total_pages>0){const t=e.current_page,i=e.total_pages;if(i<=2)for(let e=1;e<=i;e++)s.append('<div class="search-result-pagination-item '+(e===t?"active":"")+'"><a href="#" class="search-result-pagination-link" data-page="'+e+'">'+e+"</a></div>");else{const e=2,a=[],n=[];let c;for(let s=1;s<=i;s++)(1==s||s==i||s>=t-e&&s<=t+e)&&a.push(s);for(let t of a)c&&(t-c==2?n.push(c+1):t-c!=1&&n.push("...")),n.push(t),c=t;for(let e of n)"..."===e?s.append('<div class="search-result-pagination-item disabled"><span class="search-result-pagination-link">...</span></div>'):s.append('<div class="search-result-pagination-item '+(e===t?"active":"")+'"><a href="#" class="search-result-pagination-link" data-page="'+e+'">'+e+"</a></div>")}}}(i.data.pagination),u(!0)):u(!0)},error:function(t,e,s){d(),u(!0)}})}t(document).on("click",".search-filter-button",(function(){const e=t("#filterOptions"),s=e.hasClass("expanded");t(".search-filter-button").html(s?'<i class="bi bi-filter"></i> Filters':'<i class="bi bi-x"></i> Reset'),s?(e.css("opacity",0),setTimeout((()=>{e.removeClass("expanded"),e.hide()}),500)):(e.css("display","flex"),e.css("visibility","hidden"),e.addClass("expanded"),setTimeout((()=>{e.css("visibility","visible"),e.css("opacity",1)}),300)),s||r()})),t(document).on("click",".select-box",(function(e){const s=t(this).find("span i"),i=t(this).next(".options-list");i.is(":visible")?e.preventDefault():(s.toggleClass("bi-caret-down-fill bi-caret-up-fill"),i.slideToggle(300))})),t(document).on("mousedown",(function(e){t(e.target).closest(".custom-multiselect").length&&!t(e.target).closest(".select-box").length||(t(".options-list").slideUp(300),t(".select-box span i").removeClass("bi-caret-up-fill").addClass("bi-caret-down-fill"))})),t('.options-list input[type="checkbox"]').on("change",(function(){p()})),t('.options-list input[type="radio"]').on("change",(function(){p()})),s.on("click",(function(){f()})),i.on("click",(function(){let e=t(this).find("span").text();e=e.trim(),t("#adv-search-input").val(e),f()})),t("#adv-search-input").on("keyup",(function(t){"Enter"===t.key&&f()})),t(document).on("click",".search-result-pagination-link",(function(e){e.preventDefault(),t(this).data("page")!==c&&(c=n,n=t(this).data("page"),t(".search-result-pagination-item").removeClass("active"),t(this).parent().addClass("active"),f())})),t(document).on("click",".remove-filter-btn",(function(){r()})),f()}));