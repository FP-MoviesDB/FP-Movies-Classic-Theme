jQuery(document).ready((function(t){var e={};const i=t("#adv-search-btn"),s=t(".trending-searches-items"),a=t("#active-filters");let n=1,c=0,l=null,o=null;function r(){t(".custom-multiselect").each((function(){t(this).find('input[type="checkbox"]:checked').prop("checked",!1),t(this).find('input[type="radio"]:checked').prop("checked",!1)})),setTimeout((()=>{p(),f()}),100)}function p(){e={},t(".custom-multiselect").each((function(){var i=t(this).find(".select-box span").first().data("tagid"),s=t(this).find('input[type="checkbox"]:checked, input[type="radio"]:checked').map((function(){return t(this).val()})).get();s.length>0&&(e[i]=s)}))}function d(){t(".search-adv-loader").empty()}function u(t=!1){t?(i.css("pointer-events","auto"),i.css("opacity",1)):(i.css("pointer-events","none"),i.css("opacity",.5))}function f(){const i=t("#adv-search-input").val();if(i===l&&JSON.stringify(e)===JSON.stringify(o)&&n===c)return;if(a.empty(),Object.keys(e).length>0){a.append('<i class="bi bi-x remove-filter-btn px-2 py-1 text-white cursor-pointer bg-red-700 absolute -top-3 right-2 text-xs rounded-3xl">RESET</i>');let t='<div class="flex flex-wrap justify-start items-center pt-5 pb-1 gap-3">';for(const[i,s]of Object.entries(e))s.forEach((e=>{t+='<div class="active-filter-item flex justify-between items-center px-3 py-2 bg-[#333] rounded-md" data-tagid="'+i+'" data-tagvalue="'+e+'"><span class="text-white text-sm">'+e+'</span><i class="bi bi-x ml-2 text-gray-300 text-base font-semibold cursor-pointer remove-individual-filter"></i></div>'}));t+="</div>",a.append(t)}t("#search-results .search-results-list").empty(),t(".search-adv-loader").html('<div class="spinner-wrapper"><div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div></div>'),u(!1),t.ajax({url:fp_asData.ajaxurl,method:"POST",dataType:"json",data:{action:"fp_perform_search",nonce:fp_asData.nonce,search:i,filters:e,paged:n},success:function(s){d(),s.success?(l=i,o=e,function(e){const i=t("#search-results .search-results-list");if(i.empty(),0===e.length)return void i.append("<p style='text-align: center; width: 100%'>No results found</p>");e.forEach((e=>{const s=t("<div>",{class:"search-results-list-item flex justify-start items-center flex-col w-[150px] md:w-[200px] overflow-hidden"}),a=t("<a>",{href:e.p_link,class:"flex flex-col"}),n=t("<div>",{class:"overflow-hidden w-[150px] md:w-[200px] max-h-[250px] md:max-h-[300px]"}),c=t("<img>",{src:e.thumb||"https://dummyimage.com/200x2:3/333/fff.jpg?text=NO+IMAGE",alt:"Poster",class:"object-cover hover:scale-110 transition-transform duration-300 w-[150px] md:w-[200px] max-h-[250px] md:max-h-[300px] min-h-[250px] md:min-h-[300px]"}),l=t("<div>",{class:"search-results-list-item-content inline-flex flex-col"}),o=t("<h3>",{class:"adv-result-title text-sm font-semibold text-white text-center p-2 text-wrap",text:t("<div>").html(e.title).text()});l.append(o),n.append(c),a.append(n,l),s.append(a),i.append(s)}))}(s.data.results),function(e){const i=t(".search-result-pagination-wrapper");if(i.empty(),e.total_pages>0){const t=e.current_page,s=e.total_pages;if(s<=2)for(let e=1;e<=s;e++)i.append('<div class="search-result-pagination-item '+(e===t?"active":"")+'"><a href="#" class="search-result-pagination-link" data-page="'+e+'">'+e+"</a></div>");else{const e=2,a=[],n=[];let c;for(let i=1;i<=s;i++)(1==i||i==s||i>=t-e&&i<=t+e)&&a.push(i);for(let t of a)c&&(t-c==2?n.push(c+1):t-c!=1&&n.push("...")),n.push(t),c=t;for(let e of n)"..."===e?i.append('<div class="search-result-pagination-item disabled"><span class="search-result-pagination-link">...</span></div>'):i.append('<div class="search-result-pagination-item '+(e===t?"active":"")+'"><a href="#" class="search-result-pagination-link" data-page="'+e+'">'+e+"</a></div>")}}}(s.data.pagination),u(!0)):u(!0)},error:function(t,e,i){d(),u(!0)}})}t(document).on("click",".search-filter-button",(function(){const e=t("#filterOptions"),i=e.hasClass("expanded");t(".search-filter-button").html(i?'<i class="bi bi-filter"></i> Filters':'<i class="bi bi-x"></i> Reset'),i?(e.css("opacity",0),setTimeout((()=>{e.removeClass("expanded"),e.hide()}),500)):(e.css("display","flex"),e.css("visibility","hidden"),e.addClass("expanded"),setTimeout((()=>{e.css("visibility","visible"),e.css("opacity",1)}),300)),i||r()})),t(document).on("click",".select-box",(function(e){const i=t(this).find("span i"),s=t(this).next(".options-list");s.is(":visible")?e.preventDefault():(i.toggleClass("bi-caret-down-fill bi-caret-up-fill"),s.slideToggle(300))})),t(document).on("mousedown",(function(e){t(e.target).closest(".custom-multiselect").length&&!t(e.target).closest(".select-box").length||(t(".options-list").slideUp(300),t(".select-box span i").removeClass("bi-caret-up-fill").addClass("bi-caret-down-fill"))})),t('.options-list input[type="checkbox"]').on("change",(function(){p()})),t('.options-list input[type="radio"]').on("change",(function(){p()})),i.on("click",(function(){f()})),s.on("click",(function(){let e=t(this).find("span").text();e=e.trim(),t("#adv-search-input").val(e),f()})),t("#adv-search-input").on("keyup",(function(t){"Enter"===t.key&&f()})),t(document).on("click",".search-result-pagination-link",(function(e){e.preventDefault(),t(this).data("page")!==n&&(c=n,n=t(this).data("page"),t(".search-result-pagination-item").removeClass("active"),t(this).parent().addClass("active"),f())})),t(document).on("click",".remove-filter-btn",(function(){r()})),t(document).on("click",".remove-individual-filter",(function(){!function(e,i){t(".custom-multiselect").each((function(){t(this).find(".select-box span").first().data("tagid")===e&&t(this).find('input[type="checkbox"]:checked, input[type="radio"]:checked').each((function(){t(this).val()===i&&t(this).prop("checked",!1)}))}))}(t(this).parent().data("tagid"),t(this).parent().data("tagvalue")),p(),f()})),f()}));